"$schema" = "https://raw.githubusercontent.com/JanDeDobbeleer/oh-my-posh/main/themes/schema.json"
version = 3
final_space = true


[palette]
  red = "#a90000"    # oklch(45% 0.200 30) 
  gold = "#a17a00"   # oklch(60% 0.200 90) - lighter
  green = "#006b1d"  # oklch(45% 0.200 150)
  teal = "#005b95"   # oklch(45% 0.200 240)
  blue = "#2f40c2"   # oklch(45% 0.200 270)
  purple = "#6928b0" # oklch(45% 0.200 300)
  pink = "#8c0888"   # oklch(45% 0.200 330)
  orange = "#f55c1b" # fallback
  on_red = "#f4e4e5"
  on_gold = "#ede9e5"
  on_green = "#e5ece6"
  on_teal = "#e5eaf0"
  on_blue = "#e5e6f2"
  on_purple = "#e8e3ee"
  on_pink = "#ebe2eb"
  
  language = "#2f40c2"
  on_language = "#e5e6f2"

[secondary_prompt]
  template = '<p:red,transparent></><,p:red> > </><p:red,transparent></> '
  foreground = 'p:red'
  background = 'transparent'

[transient_prompt]
  template = '<p:red,transparent></><p:on_red,p:red> </><p:red,transparent></> '
  foreground = 'p:red'
  background = 'transparent'
  newline = true

[[blocks]]
  type = 'prompt'
  alignment = 'left'
  newline = true

  ######### SHELL #########

  [[blocks.segments]]
    type = 'session'
    template = '{{ if .SSHSession }} {{ end }}{{ if .Root }} {{ end }} '
    style = 'diamond'
    leading_diamond = ''
    trailing_diamond = ''
    background = 'p:red'
    foreground = 'p:on_red'
    
  ######### DIRECTORY #########

  [[blocks.segments]]
    type = 'command'
    template = ' {{ .Output }} '
    style = 'powerline'
    powerline_symbol = ''
    background = 'p:teal'
    foreground = 'p:on_teal'

    [blocks.segments.properties]
      command = '~/.config/omposh/directory'
      cache = { duration = "1h", strategy = "folder" }
  
  ######### LANGUAGES #########

  [[blocks.segments]]
    type = "python"
    template = "  {{ .Full }} "
    style = "powerline"
    powerline_symbol = ""
    background = "p:language"
    foreground = "p:on_language"

    [blocks.segments.properties]
      display_mode = "context"

  [[blocks.segments]]
    type = "go"
    template = " go {{ .Full }} "
    style = "powerline"
    powerline_symbol = ""
    background = "p:language"
    foreground = "p:on_language"

    [blocks.segments.properties]
      display_mode = "context"

  [[blocks.segments]]
    type = "lua"
    template = "  {{ .Full }} "
    style = "powerline"
    powerline_symbol = ""
    background = "p:language"
    foreground = "p:on_language"

    [blocks.segments.properties]
      display_mode = "context"

  [[blocks.segments]]
    type = "zig"
    template = "  {{ .Full }} "
    style = "powerline"
    powerline_symbol = ""
    background = "p:language"
    foreground = "p:on_language"

    [blocks.segments.properties]
      display_mode = "context"

  [[blocks.segments]]
    type = "rust"
    template = "  {{ .Full }} "
    style = "powerline"
    powerline_symbol = ""
    background = "p:language"
    foreground = "p:on_language"

    [blocks.segments.properties]
      display_mode = "context"

  # javascript: deno, svelte, react, node
  [[blocks.segments]]
    type = 'command'
    template = ' {{ .Output }} '
    style = 'powerline'
    powerline_symbol = ''
    background = "p:language"
    foreground = "p:on_language"
    
    [blocks.segments.properties]
      command = '~/.config/omposh/jsenv'
      cache = { duration = "1h", strategy = "folder" }
    
  ######### GIT #########

  [[blocks.segments]]
    type = "git"
    style = "powerline"
    powerline_symbol = ""
    background = "p:green"
    foreground = "p:on_green"
    
    background_templates = [
      "{{ if .Working.Changed }}p:gold{{ end }}",
      "{{ if or (gt .Ahead 0) (gt .Behind 0) }}p:pink{{ end }}",
    ]
    template = " {{ .HEAD }}{{ if .Working.Changed }} 󱩽{{ end }}{{ if gt .Ahead 0 }} {{ .Ahead }}{{ end }}{{ if gt .Behind 0 }} {{ .Behind }}{{ end }}{{ if and (not .Working.Changed) (eq .Ahead 0) (eq .Behind 0) }} {{ end }} "

    [blocks.segments.properties]
      fetch_status = true
      source = "cli"
      
  # endcap
  [[blocks.segments]]
    type = "text"
    style = "accordion"
    powerline_symbol = ""
    template = "  "
    background = "p:red"


######### NEW_LINE - SHELL LEVEL PROMPT #########

[[blocks]]
  type = 'prompt'
  alignment = 'left'
  newline = true

  [[blocks.segments]]
      type = "text"
      style = "plain"
      template = "{{ repeat .SHLVL \"❯\" }}"
      background = "transparent"
      foreground = "p:orange"
