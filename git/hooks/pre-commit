#!/bin/bash

echo "Running gitleaks to check for secrets in working directory..."

# Run gitleaks on the working directory (staged files)
gitleaks dir --verbose .

# Check the exit status
if [ $? -ne 0 ]; then
    echo "❌ Gitleaks found potential secrets in your staged changes!"
    echo "Please review and remove any secrets before committing."
    echo "To bypass this check (NOT recommended), use: git commit --no-verify"
    exit 1
fi

echo "✅ No secrets detected by gitleaks"
exit 0